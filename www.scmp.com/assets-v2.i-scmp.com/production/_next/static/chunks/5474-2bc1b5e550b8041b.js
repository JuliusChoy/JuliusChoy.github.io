try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="24765755-d254-45e7-97bd-7fe1755a3380",e._sentryDebugIdIdentifier="sentry-dbid-24765755-d254-45e7-97bd-7fe1755a3380")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5474],{37264:(e,n,l)=>{l.d(n,{Q:()=>t});let t=(0,l(38353).eU)({showNewBookmarkAnimation:!1,showRippleEffect:!1,showSmallRipple:!1,toggleBookmarkRippleEffect:()=>{},toggleShowNewBookmarkAnimation:()=>{}})},39718:(e,n,l)=>{l.d(n,{aB:()=>i,ey:()=>r,xk:()=>s}),l(19072),l(45582),l(86348),l(61189);var t=l(3612),a=l(29627),o=l(47977);let r=(0,t.A)("span",{target:"e1plt2it2"})("color:#ffffff;font-size:16px;font-family:",o.XT,";"),i=(0,t.A)(a.s,{target:"e1plt2it1"})("color:#4585ff;font-weight:900;font-size:16px;font-family:",o.XT,";"),s=(0,t.A)("div",{target:"e1plt2it0"})({name:"1nth7ss",styles:"position:relative;display:inline-flex;align-items:center;inline-size:fit-content"})},45474:(e,n,l)=>{l.d(n,{v:()=>ea,O:()=>el});var t,a,o,r,i,s,c,d,u,k,m,g,y,p=l(40932);l(86401),l(19072),l(45582),l(86348),l(61189),l(32496),l(92817);let f={fragment:{argumentDefinitions:[t={defaultValue:null,kind:"LocalArgument",name:"action"},a={defaultValue:null,kind:"LocalArgument",name:"entityIds"},o={defaultValue:null,kind:"LocalArgument",name:"type"}],kind:"Fragment",metadata:null,name:"hooksFollowActionMutation",selections:[{alias:"followResults",args:r=[{kind:"Variable",name:"action",variableName:"action"},{kind:"Variable",name:"entityIds",variableName:"entityIds"},{kind:"Variable",name:"type",variableName:"type"}],concreteType:"FollowConnection",kind:"LinkedField",name:"follow",plural:!1,selections:[{alias:null,args:null,concreteType:"FollowEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Follow",kind:"LinkedField",name:"node",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"targetEntityId",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,o,a],kind:"Operation",name:"hooksFollowActionMutation",selections:[{alias:"followResults",args:r,concreteType:"FollowConnection",kind:"LinkedField",name:"follow",plural:!1,selections:[{alias:null,args:null,concreteType:"FollowEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Follow",kind:"LinkedField",name:"node",plural:!1,selections:[i,s,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"ea73745a1b60089ba61fc1831a38f8ce",id:null,metadata:{},name:"hooksFollowActionMutation",operationKind:"mutation",text:"mutation hooksFollowActionMutation(\n  $action: FollowAction!\n  $type: FollowType!\n  $entityIds: [String!]!\n) {\n  followResults: follow(action: $action, type: $type, entityIds: $entityIds) {\n    edges {\n      node {\n        targetEntityId\n        type\n        id\n      }\n    }\n  }\n}\n"}};f.hash="609ca9e0789a6f11591f7e90529f11c2";let b={fragment:{argumentDefinitions:c=[{defaultValue:null,kind:"LocalArgument",name:"action"},{defaultValue:null,kind:"LocalArgument",name:"entityIds"}],kind:"Fragment",metadata:null,name:"hooksBookmarkActionMutation",selections:[{alias:"bookmarkResults",args:d=[{kind:"Variable",name:"action",variableName:"action"},{kind:"Variable",name:"entityIds",variableName:"entityIds"}],concreteType:"BookmarkConnection",kind:"LinkedField",name:"bookmark",plural:!1,selections:[{alias:null,args:null,concreteType:"BookmarkEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Bookmark",kind:"LinkedField",name:"node",plural:!1,selections:[u={alias:null,args:null,kind:"ScalarField",name:"targetEntityId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:c,kind:"Operation",name:"hooksBookmarkActionMutation",selections:[{alias:"bookmarkResults",args:d,concreteType:"BookmarkConnection",kind:"LinkedField",name:"bookmark",plural:!1,selections:[{alias:null,args:null,concreteType:"BookmarkEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Bookmark",kind:"LinkedField",name:"node",plural:!1,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"c84c9dcab4e375d9c96358eb56bf676a",id:null,metadata:{},name:"hooksBookmarkActionMutation",operationKind:"mutation",text:"mutation hooksBookmarkActionMutation(\n  $action: BookmarkAction!\n  $entityIds: [String!]!\n) {\n  bookmarkResults: bookmark(action: $action, entityIds: $entityIds) {\n    edges {\n      node {\n        targetEntityId\n        id\n      }\n    }\n  }\n}\n"}};b.hash="da7b1e549171a99ab7937b8911d65c61";let w={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"hooksFetchUserServiceQuery",selections:[{alias:null,args:k=[{kind:"Literal",name:"first",value:1e4}],concreteType:"BookmarkConnection",kind:"LinkedField",name:"bookmarks",plural:!1,selections:[{alias:null,args:null,concreteType:"BookmarkEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Bookmark",kind:"LinkedField",name:"node",plural:!1,selections:[m={alias:null,args:null,kind:"ScalarField",name:"targetEntityId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"bookmarks(first:10000)"},{alias:null,args:k,concreteType:"FollowConnection",kind:"LinkedField",name:"follows",plural:!1,selections:[{alias:null,args:null,concreteType:"FollowEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Follow",kind:"LinkedField",name:"node",plural:!1,selections:[m,g={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"follows(first:10000)"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"hooksFetchUserServiceQuery",selections:[{alias:null,args:k,concreteType:"BookmarkConnection",kind:"LinkedField",name:"bookmarks",plural:!1,selections:[{alias:null,args:null,concreteType:"BookmarkEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Bookmark",kind:"LinkedField",name:"node",plural:!1,selections:[m,y={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"bookmarks(first:10000)"},{alias:null,args:k,concreteType:"FollowConnection",kind:"LinkedField",name:"follows",plural:!1,selections:[{alias:null,args:null,concreteType:"FollowEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Follow",kind:"LinkedField",name:"node",plural:!1,selections:[m,g,y],storageKey:null}],storageKey:null}],storageKey:"follows(first:10000)"}]},params:{cacheID:"90c2baff000f3ccc3c4384bd618f3f7c",id:null,metadata:{},name:"hooksFetchUserServiceQuery",operationKind:"query",text:"query hooksFetchUserServiceQuery {\n  bookmarks(first: 10000) {\n    edges {\n      node {\n        targetEntityId\n        id\n      }\n    }\n  }\n  follows(first: 10000) {\n    edges {\n      node {\n        targetEntityId\n        type\n        id\n      }\n    }\n  }\n}\n"}};w.hash="f184ed634a94910a5e58d9b497ca4c99";var h=l(7466),v=l.n(h),F=l(40485),O=l(80853),E=l.n(O),K=l(7209),S=l.n(K),A=l(5856),L=l.n(A),B=l(69330),I=l(82915),T=l(22679),j=l(54852),D=l(13289),C=l(21482),P=l(74301),$=l(82673),x=l(61044),U=l(74262),M=l(46558);function R(e,n){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),l.push.apply(l,t)}return l}function V(e){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?R(Object(l),!0).forEach(function(n){(0,p.A)(e,n,l[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):R(Object(l)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(l,n))})}return e}var _=l(3612),z=l(29627),N=l(47977);let q=(0,_.A)("div",{target:"ef9k2dx1"})("color:#ffffff;font-size:16px;font-family:",N.XT,";"),Q=(0,_.A)(z.s,{target:"ef9k2dx0"})("color:#4585ff;font-weight:900;font-size:16px;font-family:",N.XT,";");var X=l(39718),H=l(37264),W=l(2096),J=l(72740),G=l(21472),Y=l(70702),Z=l(34266);function ee(e,n){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),l.push.apply(l,t)}return l}function en(e){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?ee(Object(l),!0).forEach(function(n){(0,p.A)(e,n,l[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):ee(Object(l)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(l,n))})}return e}let el=()=>{let{isLoggedIn:e}=(0,F.md)(P.b),n=(0,G.yu)(),l=(0,F.Xr)(Y.S),t=(0,B.useCallback)(async()=>{let e=await (0,I.fetchQuery)(n,w,{},{fetchPolicy:"network-only"}).toPromise();if((0,$.z2)(e))return{bookmarks:(null==e?void 0:e.bookmarks.edges.filter(e=>{let{node:n}=e;return(0,$.z2)(n)}).map(e=>{let{node:n}=e;return n.targetEntityId}))??[],follows:(null==e?void 0:e.follows.edges.filter(e=>{let{node:n}=e;return(0,$.z2)(n)}).map(e=>{let{node:n}=e;return`${n.type}:${n.targetEntityId}`}))??[]}},[n]),{data:a,mutate:o}=(0,D.Ay)(e?"user-service-init":null,t,{refreshInterval:36e5,revalidateOnFocus:!1,revalidateOnMount:!0,revalidateOnReconnect:!0});(0,B.useEffect)(()=>{(a||o)&&l(en(en({},a),{},{mutate:o}))},[a,o,l])},et=(e,n,l)=>e?S()(n,l):E()(n,l),ea=()=>{let{bookmarks:e,follows:n,mutate:l}=(0,F.md)(Y.S),{handleOpenSnackbar:t}=(e=>{let{enqueueSnackbar:n}=(0,U.dh)(),{enabled:l=!0}=(0,M.g)(),t=(0,x.J)(e);return{handleOpenSnackbar:(0,B.useCallback)(e=>{var a;let{duration:o,leftElement:r,rightElement:i}=e;l&&n(V(V({},t.current),{},{autoHideDuration:o,leftElement:r,rightElement:i,style:V({},null==(a=t.current)?void 0:a.style),variant:"simple"}))},[l,n,t])}})(),{isLoggedIn:a}=(0,F.md)(P.b),{openLoginDialog:o}=(0,W.g)(),{toggleBookmarkRippleEffect:r,toggleShowNewBookmarkAnimation:i}=(0,F.md)(H.Q),s=(0,G.yu)(),c=e=>{switch(e.toLowerCase()){case"author":return T.y.Author;case"section":return T.y.Section;case"topic":return T.y.Topic}},d=(0,B.useCallback)(n=>(null==e?void 0:e.includes(n))??!1,[e]),u=(0,B.useCallback)((e,l)=>{let t=c(e);return void 0!==t&&((null==n?void 0:n.includes(`${t}:${l}`))??!1)},[n]);return{bookmarkAction:(0,B.useCallback)(async(e,n,c,d)=>{var u,k;let m=e===j.t.Bookmark?"add":"remove";null!=c&&null!=(u=c.ga4Events)&&u.click&&(0,J.UL)(v()(c.ga4Events.click,{customized_parameters:{action_type:m}}),{untyped:!0});let g=()=>{let e=new URL(window.location.href);e.search=L().stringify({action:{bookmark:n}}),o({description:"Login or register to save your favourite articles.",destination:e.toString(),ga4CustomParameter:{trigger_point:"bookmark"},title:"Bookmark this story"})};if(!a)return void g();if(l)try{await l(l=>new Promise((a,o)=>{(0,I.commitMutation)(s,{mutation:b,onCompleted:n=>{var o;let{bookmarkResults:s}=n;a(en(en({},l),{},{bookmarks:et(e===j.t.Bookmark,(null==l?void 0:l.bookmarks)??[],s.edges.map(e=>{let{node:n}=e;return n.targetEntityId}))})),null!=c&&null!=(o=c.ga4Events)&&o.click&&(0,J.UL)(v()(c.ga4Events.click,{action:"sys",customized_parameters:{action_type:m}}),{untyped:!0}),t({duration:4e3,leftElement:(0,Z.jsx)(q,{"data-qa":"useUserService-bookmarkAction-StyledSnackbarMessage",children:e===j.t.Bookmark?"Bookmarked":"Unbookmarked"}),rightElement:(0,Z.jsx)(Q,{pathname:`${C.$.account.scmpAccountHost}/manage/bookmark`,"data-qa":"useUserService-bookmarkAction-StyledSnackbarAction",children:"View all"})}),e===j.t.Bookmark&&(r(),i(!0)),null==d||d()},onError:e=>{o(e)},variables:{action:e,entityIds:[n]}})}),{optimisticData:l=>en(en({},l),{},{bookmarks:et(e===j.t.Bookmark,(null==l?void 0:l.bookmarks)??[],[n])}),populateCache:!0,revalidate:!1,rollbackOnError:!0})}catch(e){(null==e||null==(k=e.res)?void 0:k.status)===401&&g()}},[s,t,a,l,o,r,i]),checkIsBookmarked:d,checkIsFollowed:u,followAction:(0,B.useCallback)(async(e,n,o,r)=>{if(!a||!l)return;let i=c(n);if(void 0!==i)try{await l(n=>new Promise((l,a)=>{(0,I.commitMutation)(s,{mutation:f,onCompleted:a=>{let{followResults:o}=a;l(en(en({},n),{},{follows:et(e===T.WD.Follow,(null==n?void 0:n.follows)??[],o.edges.map(e=>{let{node:n}=e;return`${n.type}:${n.targetEntityId}`}))})),t({duration:4e3,leftElement:(0,Z.jsx)(X.ey,{"data-qa":"useUserService-followAction-SnackbarMessageContainer",children:e===T.WD.Follow?"Following":"Unfollowed"}),rightElement:(0,Z.jsx)(X.aB,{pathname:C.$.account.scmpAccountHost+"/manage/following","data-qa":"useUserService-followAction-SnackbarViewAllLink",children:"View all"})}),null==r||r()},onError:e=>{a(e)},variables:{action:e,entityIds:o,type:i}})}),{optimisticData:n=>en(en({},n),{},{follows:et(e===T.WD.Follow,(null==n?void 0:n.follows)??[],o.map(e=>`${i}:${e}`))}),populateCache:!0,revalidate:!1,rollbackOnError:!0})}catch(e){null==r||r(e)}},[s,t,a,l]),follows:n}}},46558:(e,n,l)=>{l.d(n,{g:()=>c,m:()=>s});var t=l(2798),a=l(69330),o=l(34266);let r=["children"],i=(0,a.createContext)({enabled:!0}),s=e=>{let{children:n}=e,l=(0,t.A)(e,r);return(0,o.jsx)(i.Provider,{value:l,children:n})};s.displayName="SimpleSnackbarContextProvider";let c=()=>(0,a.useContext)(i)},54852:(e,n,l)=>{var t;l.d(n,{t:()=>a});let a=((t={}).Bookmark="Bookmark",t.UnBookmark="UnBookmark",t)},70702:(e,n,l)=>{l.d(n,{S:()=>t});let t=(0,l(38353).eU)({})}}]);
//# sourceMappingURL=5474-2bc1b5e550b8041b.js.map